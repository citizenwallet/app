<!DOCTYPE html>
<html>
  <head>
    <!--
    If you are serving your web app in a path other than the root, change the
    href value below to reflect the base path you are serving from.

    The path provided below has to start and end with a slash "/" in order for
    it to work correctly.

    For more details:
    * https://developer.mozilla.org/en-US/docs/Web/HTML/Element/base

    This is a placeholder for base href that will be replaced by the value of
    the `--base-href` argument provided to `flutter build`.
  -->
    <base href="$FLUTTER_BASE_HREF" />

    <meta charset="UTF-8" />
    <meta content="IE=Edge" http-equiv="X-UA-Compatible" />
    <meta name="description" content="Simplify transactions." />

    <!-- iOS meta tags & icons -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="apple-mobile-web-app-title" content="citizenwallet" />
    <link rel="apple-touch-icon" href="icons/Icon-192.png" />

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="favicon.png" />
    <link rel="mask-icon" href="favicon.png" color="#000000" />

    <title>Citizen Wallet</title>
    <link rel="manifest" href="manifest.json" />

    <script
      type="text/javascript"
      src="https://unpkg.com/@zxing/library@0.19.1"
    ></script>

    <script>
      // The value below is injected by flutter build, do not touch.
      var serviceWorkerVersion = null;
    </script>
    <!-- This script adds the flutter initialization JS code -->
    <script src="flutter.js" defer></script>
  </head>

  <style>
    html,
    body {
      height: 100%;
      width: 100%;
      margin: 0;
      padding: 0;
    }

    .abs-wrapper {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: white;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      align-content: center;
    }
    .padded-wrapper {
      width: 60%;

      display: flex;
      flex-direction: row;
      align-items: center;
      justify-content: center;
      align-content: center;
    }

    .lds-spinner {
      color: black;
      display: inline-block;
      position: relative;
      width: 80px;
      height: 80px;
      transform: scale(0.35);
    }
    .lds-spinner div {
      transform-origin: 40px 40px;
      animation: lds-spinner 1.2s linear infinite;
    }
    .lds-spinner div:after {
      content: " ";
      display: block;
      position: absolute;
      top: 3px;
      left: 37px;
      width: 6px;
      height: 18px;
      border-radius: 20%;
      background: rgba(0, 0, 0, 0.25);
    }
    .lds-spinner div:nth-child(1) {
      transform: rotate(0deg);
      animation-delay: -1.1s;
    }
    .lds-spinner div:nth-child(2) {
      transform: rotate(30deg);
      animation-delay: -1s;
    }
    .lds-spinner div:nth-child(3) {
      transform: rotate(60deg);
      animation-delay: -0.9s;
    }
    .lds-spinner div:nth-child(4) {
      transform: rotate(90deg);
      animation-delay: -0.8s;
    }
    .lds-spinner div:nth-child(5) {
      transform: rotate(120deg);
      animation-delay: -0.7s;
    }
    .lds-spinner div:nth-child(6) {
      transform: rotate(150deg);
      animation-delay: -0.6s;
    }
    .lds-spinner div:nth-child(7) {
      transform: rotate(180deg);
      animation-delay: -0.5s;
    }
    .lds-spinner div:nth-child(8) {
      transform: rotate(210deg);
      animation-delay: -0.4s;
    }
    .lds-spinner div:nth-child(9) {
      transform: rotate(240deg);
      animation-delay: -0.3s;
    }
    .lds-spinner div:nth-child(10) {
      transform: rotate(270deg);
      animation-delay: -0.2s;
    }
    .lds-spinner div:nth-child(11) {
      transform: rotate(300deg);
      animation-delay: -0.1s;
    }
    .lds-spinner div:nth-child(12) {
      transform: rotate(330deg);
      animation-delay: 0s;
    }
    @keyframes lds-spinner {
      0% {
        opacity: 1;
      }
      100% {
        opacity: 0;
      }
    }

    .loading-text {
      font-size: 1.8rem;
      margin-top: 1rem;
      font-family: system-ui;
      text-align: center;
    }

    .spacing {
      margin-top: 30px;
    }

    .loading-bar-track {
      width: 60%;
      height: 10px;

      background-color: #f3f3f3;

      border-radius: 10px;
    }
    .loading-bar {
      height: 10px;

      background-color: rgba(200, 255, 148, 1);

      border-radius: 10px;

      -webkit-animation-name: pulse; /* Chrome, Safari, Opera */
      -webkit-animation-duration: 1s; /* Chrome, Safari, Opera */
      -webkit-animation-iteration-count: infinite;
      animation-name: pulse;
      animation-duration: 1s;
      animation-iteration-count: infinite;

      transition: width 0.25s ease-in-out;
    }
    .loading-bar-0 {
      width: 0%;
    }
    .loading-bar-25 {
      width: 25%;
    }
    .loading-bar-50 {
      width: 50%;
    }
    .loading-bar-75 {
      width: 75%;
    }
    .loading-bar-90 {
      width: 90%;
    }
    .loading-bar-100 {
      width: 100%;
    }
    @-webkit-keyframes pulse {
      0% {
        background-color: rgba(200, 255, 148, 1);
      }
      25% {
        background-color: rgba(200, 255, 148, 0.9);
      }
      50% {
        background-color: rgba(200, 255, 148, 0.8);
      }
      75% {
        background-color: rgba(200, 255, 148, 0.8);
      }
      85% {
        background-color: rgba(200, 255, 148, 0.9);
      }
      100% {
        background-color: rgba(200, 255, 148, 1);
      }
    }

    @keyframes pulse {
      0% {
        background-color: rgba(200, 255, 148, 1);
      }
      25% {
        background-color: rgba(200, 255, 148, 0.8);
      }
      50% {
        background-color: rgba(200, 255, 148, 0.6);
      }
      75% {
        background-color: rgba(200, 255, 148, 0.6);
      }
      85% {
        background-color: rgba(200, 255, 148, 0.8);
      }
      100% {
        background-color: rgba(200, 255, 148, 1);
      }
    }
    .title {
      font-family: system-ui;
      font-size: 4rem;
      text-align: center;
    }
    .sub-title {
      font-family: system-ui;
      font-size: 2.2rem;
      text-align: center;
    }
    .sub-sub-title {
      font-family: system-ui;
      font-size: 1.8rem;
      text-align: center;
    }
  </style>
  <body>
    <div class="abs-wrapper">
      <h1 class="title">Citizen Wallet</h1>
      <div class="padded-wrapper">
        <p class="sub-title">Your wallet is being prepared.</p>
      </div>
      <div class="padded-wrapper">
        <p class="sub-sub-title">
          This may take a couple of seconds the very first time.
        </p>
      </div>
      <div class="lds-spinner spacing">
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
      </div>
      <div class="loading-bar-track">
        <div id="loading-bar" class="loading-bar loading-bar-0"></div>
      </div>
      <div class="padded-wrapper spacing">
        <div id="loading-text" class="loading-text">Setting things up...</div>
      </div>
    </div>
    <noscript class="abs-wrapper">
      <h1>Unable to load</h1>
      <p>You need to enable JavaScript to run this app.</p>
    </noscript>
    <script>
      window.addEventListener("load", function (ev) {
        var loadingBar = document.querySelector("#loading-bar");
        loadingBar.classList.remove("loading-bar-0");
        loadingBar.classList.add("loading-bar-25");

        var loading = document.querySelector("#loading-text");
        loading.textContent = "Downloading files...";

        var long25Timeout = setTimeout(function () {
          loading.textContent = "Downloading files (good things take time)...";
          loadingBar.classList.remove("loading-bar-25");
          loadingBar.classList.add("loading-bar-50");
        }, 3000);

        // Download main.dart.js
        _flutter.loader.loadEntrypoint({
          serviceWorker: {
            serviceWorkerVersion: serviceWorkerVersion,
          },
          onEntrypointLoaded: function (engineInitializer) {
            clearTimeout(long25Timeout);

            loading.textContent = "Installing Citizen Wallet...";

            if (loadingBar.classList.contains("loading-bar-25"))
              loadingBar.classList.remove("loading-bar-25");
            if (loadingBar.classList.contains("loading-bar-50"))
              loadingBar.classList.remove("loading-bar-50");
            loadingBar.classList.add("loading-bar-75");

            var long75Timeout = setTimeout(function () {
              loading.textContent =
                "Installing Citizen Wallet (it's worth it, we promise)...";
              loadingBar.classList.remove("loading-bar-75");
              loadingBar.classList.add("loading-bar-90");
            }, 3000);

            engineInitializer
              .initializeEngine()
              .then(function (appRunner) {
                clearTimeout(long75Timeout);

                loading.textContent = "Launching your wallet...";
                loadingBar.classList.remove("loading-bar-75");
                loadingBar.classList.add("loading-bar-100");
                appRunner.runApp();
              })
              .catch(function (error) {
                loading.textContent = "Error loading wallet";
              });
          },
        });
      });
    </script>
  </body>
</html>
